{% extends "base.html" %}

{% block title %}번역 - 위카아라이 진단시스템{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <div class="page-header">
        <div class="d-flex justify-content-between align-items-center">
            <h2><i class="bi bi-translate"></i> 일본어 번역</h2>
            <button onclick="window.close()" class="btn btn-outline-secondary">
                <i class="bi bi-x-circle"></i> 이전페이지로
            </button>
        </div>
    </div>
    
    <div class="card mb-4">
        <div class="card-body">
            <div class="row">
                <div class="col-md-3"><strong>신청일:</strong> {{ diagnosis.request_date }}</div>
                <div class="col-md-3"><strong>차량번호:</strong> {{ diagnosis.vehicle_number or '' }}</div>
                <div class="col-md-3"><strong>출품번호:</strong> {{ diagnosis.lot_number or '' }}</div>
                <div class="col-md-3"><strong>주차번호:</strong> {{ diagnosis.parking_number or '' }}</div>
            </div>
            <div class="row mt-2">
                <div class="col-md-3"><strong>평가사명:</strong> {{ diagnosis.evaluator_name or '' }}</div>
            </div>
        </div>
    </div>
    
    <div class="card mb-4">
        <div class="card-header bg-info text-white">
            <h5 class="mb-0"><i class="bi bi-translate"></i> 번역된 정보 (일본어)</h5>
        </div>
        <div class="card-body">
            <div class="row">
                {% if translated_headers.vehicle_number %}
                <div class="col-md-3 mb-2"><strong>{{ translated_headers.vehicle_number }}</strong></div>
                {% endif %}
                {% if translated_headers.lot_number %}
                <div class="col-md-3 mb-2"><strong>{{ translated_headers.lot_number }}</strong></div>
                {% endif %}
                {% if translated_headers.parking_number %}
                <div class="col-md-3 mb-2"><strong>{{ translated_headers.parking_number }}</strong></div>
                {% endif %}
                {% if translated_headers.evaluator_name %}
                <div class="col-md-3 mb-2"><strong>{{ translated_headers.evaluator_name }}</strong></div>
                {% endif %}
            </div>
        </div>
    </div>
    
    <div class="card">
        <div class="card-header bg-info text-white">
            <h5 class="mb-0"><i class="bi bi-translate"></i> 번역된 내용 (일본어)</h5>
        </div>
        <div class="card-body">
            <div class="table-wrapper">
                <table class="table table-bordered">
                    <thead class="table-fixed-header">
                        <tr>
                            <th>順</th>
                            <th>診断申請内容</th>
                            <th>回答</th>
                            <th>備考</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for row in translated_table_data %}
                        <tr>
                            <td>{{ row.sequence }}</td>
                            <td>{{ row.request_content }}</td>
                            <td>{{ row.response_content }}</td>
                            <td>{{ row.note }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            <button class="btn btn-outline-primary mt-3" onclick="copyToClipboard()">
                <i class="bi bi-clipboard"></i> 복사
            </button>
        </div>
    </div>
    
    <div class="text-center mt-4 mb-4">
        <img src="{{ url_for('static', filename='images/lpgo.png') }}" alt="위카 로고" style="max-width: 150px;">
        <p class="mt-2"><strong>위카모빌리티 주식회사</strong></p>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
function copyToClipboard() {
    // 표 형식의 텍스트를 복사
    let text = '';
    
    // 헤더 정보
    const headerDivs = document.querySelectorAll('.card-body .row .col-md-3');
    headerDivs.forEach(div => {
        if (div.textContent.trim()) {
            text += div.textContent.trim() + '\n';
        }
    });
    
    text += '\n';
    text += '順\t診断申請内容\t回答\t備考\n';
    
    // 테이블 데이터
    const rows = document.querySelectorAll('table tbody tr');
    rows.forEach(row => {
        const cells = row.querySelectorAll('td');
        const rowText = Array.from(cells).map(cell => cell.textContent.trim()).join('\t');
        text += rowText + '\n';
    });
    
    navigator.clipboard.writeText(text).then(function() {
        alert('클립보드에 복사되었습니다.');
    });
}
</script>
{% endblock %}


